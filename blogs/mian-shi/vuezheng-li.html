<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue整理 | ccy&#39;s blogs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/ccyblog/favicon.ico">
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/UsernameFull/l2d@0.2/js/frame/live2dcubismcore.min.js"></script>
    <script src="https://pixijs.download/v4.8.4/pixi.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/litstronger/live2d-moc3@master/js/live2dcubismframework.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/litstronger/live2d-moc3@master/js/live2dcubismpixi.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/litstronger/live2d-moc3@master/js/l2d.js"></script>
    <meta name="description" content="个人技术博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/ccyblog/assets/css/0.styles.79d32354.css" as="style"><link rel="preload" href="/ccyblog/assets/js/app.61cc9ff9.js" as="script"><link rel="preload" href="/ccyblog/assets/js/3.897744a6.js" as="script"><link rel="preload" href="/ccyblog/assets/js/1.371d3697.js" as="script"><link rel="preload" href="/ccyblog/assets/js/74.d901de2d.js" as="script"><link rel="preload" href="/ccyblog/assets/js/8.b19724a0.js" as="script"><link rel="prefetch" href="/ccyblog/assets/js/10.a51d9fc9.js"><link rel="prefetch" href="/ccyblog/assets/js/11.8d124275.js"><link rel="prefetch" href="/ccyblog/assets/js/12.a334a46b.js"><link rel="prefetch" href="/ccyblog/assets/js/13.8010945d.js"><link rel="prefetch" href="/ccyblog/assets/js/14.8e3c3ac4.js"><link rel="prefetch" href="/ccyblog/assets/js/15.81bd0ba2.js"><link rel="prefetch" href="/ccyblog/assets/js/16.232611db.js"><link rel="prefetch" href="/ccyblog/assets/js/17.667dde35.js"><link rel="prefetch" href="/ccyblog/assets/js/18.71e79375.js"><link rel="prefetch" href="/ccyblog/assets/js/19.f10b5e62.js"><link rel="prefetch" href="/ccyblog/assets/js/20.dd05ecdc.js"><link rel="prefetch" href="/ccyblog/assets/js/21.4a07e2cf.js"><link rel="prefetch" href="/ccyblog/assets/js/22.29c735e7.js"><link rel="prefetch" href="/ccyblog/assets/js/23.04beb3f2.js"><link rel="prefetch" href="/ccyblog/assets/js/24.e4efbb4f.js"><link rel="prefetch" href="/ccyblog/assets/js/25.63de8752.js"><link rel="prefetch" href="/ccyblog/assets/js/26.1a8c82ca.js"><link rel="prefetch" href="/ccyblog/assets/js/27.47678a4d.js"><link rel="prefetch" href="/ccyblog/assets/js/28.4d87f639.js"><link rel="prefetch" href="/ccyblog/assets/js/29.d613dcd8.js"><link rel="prefetch" href="/ccyblog/assets/js/30.610dbdf4.js"><link rel="prefetch" href="/ccyblog/assets/js/31.c4817f6d.js"><link rel="prefetch" href="/ccyblog/assets/js/32.7af520a4.js"><link rel="prefetch" href="/ccyblog/assets/js/33.5ce06274.js"><link rel="prefetch" href="/ccyblog/assets/js/34.b2117dfb.js"><link rel="prefetch" href="/ccyblog/assets/js/35.377603e6.js"><link rel="prefetch" href="/ccyblog/assets/js/36.883e88a6.js"><link rel="prefetch" href="/ccyblog/assets/js/37.872a7cdf.js"><link rel="prefetch" href="/ccyblog/assets/js/38.18f351f9.js"><link rel="prefetch" href="/ccyblog/assets/js/39.0487dd57.js"><link rel="prefetch" href="/ccyblog/assets/js/4.9b4181ee.js"><link rel="prefetch" href="/ccyblog/assets/js/40.abacd655.js"><link rel="prefetch" href="/ccyblog/assets/js/41.abf116df.js"><link rel="prefetch" href="/ccyblog/assets/js/42.7f9de919.js"><link rel="prefetch" href="/ccyblog/assets/js/43.d41da37b.js"><link rel="prefetch" href="/ccyblog/assets/js/44.7c2519a6.js"><link rel="prefetch" href="/ccyblog/assets/js/45.29a6bc83.js"><link rel="prefetch" href="/ccyblog/assets/js/46.5f6478d4.js"><link rel="prefetch" href="/ccyblog/assets/js/47.631bdc1f.js"><link rel="prefetch" href="/ccyblog/assets/js/48.6df6dfd4.js"><link rel="prefetch" href="/ccyblog/assets/js/49.8fdfb49c.js"><link rel="prefetch" href="/ccyblog/assets/js/5.bd4235cd.js"><link rel="prefetch" href="/ccyblog/assets/js/50.88f2f8bf.js"><link rel="prefetch" href="/ccyblog/assets/js/51.f502157e.js"><link rel="prefetch" href="/ccyblog/assets/js/52.9bf27ff9.js"><link rel="prefetch" href="/ccyblog/assets/js/53.56ba7eeb.js"><link rel="prefetch" href="/ccyblog/assets/js/54.212c55f1.js"><link rel="prefetch" href="/ccyblog/assets/js/55.6fc8672f.js"><link rel="prefetch" href="/ccyblog/assets/js/56.8cbf943d.js"><link rel="prefetch" href="/ccyblog/assets/js/57.8b84c069.js"><link rel="prefetch" href="/ccyblog/assets/js/58.df9fd31e.js"><link rel="prefetch" href="/ccyblog/assets/js/59.4a889f7f.js"><link rel="prefetch" href="/ccyblog/assets/js/6.1ebcf0d6.js"><link rel="prefetch" href="/ccyblog/assets/js/60.045b3756.js"><link rel="prefetch" href="/ccyblog/assets/js/61.4e8f609c.js"><link rel="prefetch" href="/ccyblog/assets/js/62.4fe15d75.js"><link rel="prefetch" href="/ccyblog/assets/js/63.e9ac2545.js"><link rel="prefetch" href="/ccyblog/assets/js/64.083e8d2c.js"><link rel="prefetch" href="/ccyblog/assets/js/65.b6e595bc.js"><link rel="prefetch" href="/ccyblog/assets/js/66.26689277.js"><link rel="prefetch" href="/ccyblog/assets/js/67.60ccd17c.js"><link rel="prefetch" href="/ccyblog/assets/js/68.42b6df4a.js"><link rel="prefetch" href="/ccyblog/assets/js/69.1d5ac1c5.js"><link rel="prefetch" href="/ccyblog/assets/js/7.58212ba9.js"><link rel="prefetch" href="/ccyblog/assets/js/70.6b794575.js"><link rel="prefetch" href="/ccyblog/assets/js/71.09fac264.js"><link rel="prefetch" href="/ccyblog/assets/js/72.ee6a2190.js"><link rel="prefetch" href="/ccyblog/assets/js/73.da9be3f4.js"><link rel="prefetch" href="/ccyblog/assets/js/75.a8f3a837.js"><link rel="prefetch" href="/ccyblog/assets/js/76.26405b7a.js"><link rel="prefetch" href="/ccyblog/assets/js/77.abe05554.js"><link rel="prefetch" href="/ccyblog/assets/js/78.6fd39cf3.js"><link rel="prefetch" href="/ccyblog/assets/js/79.5a5a23fb.js"><link rel="prefetch" href="/ccyblog/assets/js/80.5de6685c.js"><link rel="prefetch" href="/ccyblog/assets/js/81.452915be.js"><link rel="prefetch" href="/ccyblog/assets/js/82.04c6cc59.js"><link rel="prefetch" href="/ccyblog/assets/js/83.8288a3e4.js"><link rel="prefetch" href="/ccyblog/assets/js/84.e49e3728.js"><link rel="prefetch" href="/ccyblog/assets/js/85.8ad8ef5d.js"><link rel="prefetch" href="/ccyblog/assets/js/86.1d4c8e78.js"><link rel="prefetch" href="/ccyblog/assets/js/87.fc6b54da.js"><link rel="prefetch" href="/ccyblog/assets/js/88.1e7cf8b0.js"><link rel="prefetch" href="/ccyblog/assets/js/9.a8e5976d.js">
    <link rel="stylesheet" href="/ccyblog/assets/css/0.styles.79d32354.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>ccy's blogs</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>个人技术博客</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>月夕花辰</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ccyblog/" class="home-link router-link-active"><img src="/ccyblog/avatar.png" alt="ccy's blogs" class="logo"> <span class="site-name">ccy's blogs</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ccyblog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ccyblog/categories/配置/" class="nav-link"><i class="undefined"></i>
  配置
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/手写题/" class="nav-link"><i class="undefined"></i>
  手写题
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/直播/" class="nav-link"><i class="undefined"></i>
  直播
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/笔记/" class="nav-link"><i class="undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/网络/" class="nav-link"><i class="undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/面试/" class="nav-link"><i class="undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/CSS/" class="nav-link"><i class="undefined"></i>
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/优化/" class="nav-link"><i class="undefined"></i>
  优化
</a></li></ul></div></div><div class="nav-item"><a href="/ccyblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/ccyblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/FrancisSaber" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="./public/avatar.png"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/ccyblog/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    月夕花辰
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>72</h3> <h6 data-v-828910c6>文章</h6></div> <div data-v-828910c6><h3 data-v-828910c6>19</h3> <h6 data-v-828910c6>标签</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/ccyblog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ccyblog/categories/配置/" class="nav-link"><i class="undefined"></i>
  配置
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/vue/" class="nav-link"><i class="undefined"></i>
  vue
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/手写题/" class="nav-link"><i class="undefined"></i>
  手写题
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/直播/" class="nav-link"><i class="undefined"></i>
  直播
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/笔记/" class="nav-link"><i class="undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/网络/" class="nav-link"><i class="undefined"></i>
  网络
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/面试/" class="nav-link"><i class="undefined"></i>
  面试
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/Webpack/" class="nav-link"><i class="undefined"></i>
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/CSS/" class="nav-link"><i class="undefined"></i>
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/ccyblog/categories/优化/" class="nav-link"><i class="undefined"></i>
  优化
</a></li></ul></div></div><div class="nav-item"><a href="/ccyblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/ccyblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/FrancisSaber" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="./public/avatar.png"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>面试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ccyblog/blogs/mian-shi/httpqing-qiu.html" class="sidebar-link">http请求</a></li><li><a href="/ccyblog/blogs/mian-shi/javascriptbian-yi-zhi-xing.html" class="sidebar-link">JavaScript代码的执行</a></li><li><a href="/ccyblog/blogs/mian-shi/vite.html" class="sidebar-link">Vite</a></li><li><a href="/ccyblog/blogs/mian-shi/vuexiang-ying-shi.html" class="sidebar-link">过程</a></li><li><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html" aria-current="page" class="active sidebar-link">Vue整理</a></li><li><a href="/ccyblog/blogs/mian-shi/wbepackliu-cheng.html" class="sidebar-link">Webpack</a></li><li><a href="/ccyblog/blogs/mian-shi/webpack.html" class="sidebar-link">流程</a></li><li><a href="/ccyblog/blogs/mian-shi/csszheng-li.html" class="sidebar-link">CSS整理</a></li><li><a href="/ccyblog/blogs/mian-shi/dan-dian-deng-lu.html" class="sidebar-link">单点登录</a></li><li><a href="/ccyblog/blogs/mian-shi/chang-jian-jsti-mu.html" class="sidebar-link">作用域和this指向</a></li><li><a href="/ccyblog/blogs/mian-shi/pai-xu-suan-fa-ji-shi-jian-fu-za-du.html" class="sidebar-link">希尔排序</a></li><li><a href="/ccyblog/blogs/mian-shi/liu-lan-qi-xuan-ran-ji-zhi.html" class="sidebar-link">HTML解析</a></li><li><a href="/ccyblog/blogs/mian-shi/xuan-ran-ceng-he-bing.html" class="sidebar-link">渲染层合并</a></li><li><a href="/ccyblog/blogs/mian-shi/ji-suan-ji-wang-luo.html" class="sidebar-link">计算机网络</a></li><li><a href="/ccyblog/blogs/mian-shi/she-ji-mo-shi.html" class="sidebar-link">装饰器模式</a></li><li><a href="/ccyblog/blogs/mian-shi/mian-shi-ti-bi-ji.html" class="sidebar-link">面试题目</a></li><li><a href="/ccyblog/blogs/mian-shi/ye-mian-you-hua.html" class="sidebar-link">页面优化</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Vue整理</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>月夕花辰</span>
            
          <span data-v-4e82dffc>2021 - </span>
          2022
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">Vue整理</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>月夕花辰</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>2022/3/6</span></i> <!----> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>面</span><span class="tag-item" data-v-1ff7123e>试</span><span class="tag-item" data-v-1ff7123e> </span><span class="tag-item" data-v-1ff7123e>-</span></i></div></div> <div class="theme-reco-content content__default"><h1 id="mvc和mvvm"><a href="#mvc和mvvm" class="header-anchor">#</a> MVC和MVVM</h1> <h2 id="mvc"><a href="#mvc" class="header-anchor">#</a> MVC</h2> <p>​		MVC 全名是 Model View Controller，是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范</p> <ul><li>Model（模型）：model层用来存储业务数据，一旦数据变化就通知相关视图更新</li> <li>View（视图）：是应用程序中处理数据显示的部分。通常视图是依据模型数据创建的</li> <li>Controller（控制器）：是应用程序中处理用户交互的部分。通常控制器负责从视图读取数据，控制用户输入，并向模型发送数据</li></ul> <p>MVC 的思想：用户对视图层的操作交给controller层处理，控制层响应视图层的事件通过模型层的接口操作数据。</p> <img src="https://cdn.jsdelivr.net/gh/FrancisSaber/image/markdown-Image202203062212261.webp" alt="mvc.png" style="zoom:67%;"> <h2 id="mvvm"><a href="#mvvm" class="header-anchor">#</a> MVVM</h2> <p>MVVM将视图层和模型层同步逻辑自动化了，框架能够自动实现数据绑定。MVVM中的View通过使用模板语法来声明式的将数据渲染进DOM，当ViewModel对Model进行更新的时候，会通过数据绑定更新到View。写法如下：</p> <p>ViewModel：做了两件事达到了数据的双向绑定 一是将【模型】转化成【视图】，即将后端传</p> <p>递的数据转化成所看到的页面。实现的方式是：数据绑定。二是将【视图】转化成【模型】，即将所看到的页面转化成后端的数据。实现的方式是：DOM 事件监听。</p> <h2 id="区别"><a href="#区别" class="header-anchor">#</a> 区别</h2> <p>MVVM 与 MVC 最大的区别就是：它实现了 View 和 Model 的自动同步，也就是当 Model 的属性改变时，我们不用再自己手动操作 Dom 元素，来改变 View 的显示，而是改变属性后该属性对应 View 层显示会自动改变。</p> <p><font color="orange">MVVM不需要controller来根据model层更新视图，VM层已经实现了双向数据绑定</font></p> <h2 id="vue模型"><a href="#vue模型" class="header-anchor">#</a> Vue模型</h2> <p>Vue没有完全遵循MVVM，因为严格的MVVM要求view不能和model直接通信，但Vue提供的<code>$refs</code>这个属性让<code>Model</code>可以直接操作<code>View</code></p> <h1 id="vue生命周期"><a href="#vue生命周期" class="header-anchor">#</a> Vue生命周期</h1> <p>https://juejin.cn/post/6844903780736040973</p> <h2 id="beforecreate"><a href="#beforecreate" class="header-anchor">#</a> beforeCreate</h2> <p>Vue实例初始化之前调用</p> <h2 id="created"><a href="#created" class="header-anchor">#</a> created</h2> <p>这个阶段 vue 实例在内存中已经创建好了，data 和 methods 也能够获取到了，但是模板还没编译。</p> <h2 id="beforemount"><a href="#beforemount" class="header-anchor">#</a> beforeMount</h2> <p>判断是否存在挂载节点，如果不存在render返回一个空节点</p> <h2 id="mount"><a href="#mount" class="header-anchor">#</a> mount</h2> <p><code>$mount</code> 这个方法的实现是和平台、构建方式都相关的</p> <blockquote><ul><li><code>./src/platforms/web/entry-runtime-with-compiler.js</code>(带<code>compiler</code>)</li> <li><code>./src/platforms/web/runtime/index.js</code>(不带compiler)</li> <li><code>./src/platform/weex/runtime/index.js</code>(跨平台)</li></ul></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/*
	./src/platforms/web/entry-runtime-with-compiler.js(带compiler)中的$mount
	对于带compiler的mount（挂载）方法，它缓存源码core内的lifecycle内的mount方法并重定义，会检查是否存在render方法，不存在的话会将template字符串转为render函数，它是通过调用compileToFunctions方法实现的，最后调用原来的$mount方法挂载
*/</span>
<span class="token comment">//不完整的运行时mount方法</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
    el<span class="token operator">?</span><span class="token operator">:</span>string <span class="token operator">|</span> Element   <span class="token comment">//可以是字符串或元素</span>
    hydrating<span class="token operator">?</span><span class="token operator">:</span> boolean
<span class="token punctuation">)</span><span class="token operator">:</span> Component <span class="token punctuation">{</span>
	el <span class="token operator">=</span> el <span class="token operator">&amp;&amp;</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>el <span class="token operator">===</span> body <span class="token operator">||</span> el <span class="token operator">===</span> document<span class="token punctuation">.</span>doucementElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//判断el不能是body或html节点，因为vue是通过对节点进行替换，替换了body或html节点会导致文档不规范</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> template <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>template<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//如果options存在template，根据el获取模板</span>
            <span class="token comment">//根据id或者或innerHTML获取</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			template <span class="token operator">=</span> <span class="token function">getOuterHTML</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//获取这个el节点本身的模板</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">{</span>
		template <span class="token operator">=</span> <span class="token function">getOuterHTML</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//如果存在template，通过compileToFunctions将模板转为渲染函数</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>render<span class="token punctuation">,</span> staticRenderFns<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">compileToFunctions</span><span class="token punctuation">(</span>template<span class="token punctuation">)</span>
    <span class="token comment">//拿到渲染函数挂载到options上</span>
    options<span class="token punctuation">.</span>render <span class="token operator">=</span> render<span class="token punctuation">;</span>
    <span class="token comment">//最后通过call调用挂载函数</span>
    <span class="token keyword">return</span> <span class="token function">mount</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//最后call调用的mount内部是执行了mountComponent方法</span>

<span class="token comment">//</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>
	<span class="token parameter">el<span class="token operator">?</span> <span class="token operator">:</span> el <span class="token operator">&amp;&amp;</span> Element<span class="token punctuation">,</span>
     <span class="token literal-property property">hydrating</span><span class="token operator">:</span> Boolean</span>
<span class="token punctuation">)</span><span class="token operator">:</span> Compoent <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el <span class="token operator">&amp;&amp;</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$document<span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
	/src/core/instance/lifecycle
	mountComponent方法会将el挂载到vm上
	暴露beforeMount钩子
	定义updateCompontent，通过render生成虚拟节点，通过update进行diff同时生成真实的DOM
	实例化一个render Watcher，对于渲染函数watcher，其第五个参数为布尔值标记为渲染函数侦测者
	这是vue响应式的重要过程，在updateComponent执行过程会将watcher加入到访问到属性的依赖，在状态更新时watcher得到通知执行视图更新
	在new Watcher后会暴露mount钩子
	
	watcher所订阅的数据更新时，状态会触发update方法，内部会重新获取侦测对象，对于渲染函数watcher，其侦测的属性是updateComponet会自动生成虚拟节点进行比较更新视图
*/</span>
<span class="token keyword">function</span> <span class="token function">mountComponet</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> el<span class="token punctuation">;</span>		<span class="token comment">//将用户定义的el挂载到实例的$el属性上</span>
    <span class="token comment">//判断是否存在options是否存在render方法，不存在给render一个空节点，在生产环境下报错</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//暴露钩子函数</span>
    <span class="token keyword">let</span> updateComponent
    <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>preformance <span class="token operator">&amp;&amp;</span> mark<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//一系列初始化</span>
        <span class="token keyword">const</span> vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
             vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//第一个参数为vm实例，第二个参数为侦测属性，第三个为回调函数，第四个为options对象（是否深度监听等）</span>
    vm<span class="token punctuation">.</span>_watcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token comment">//此函数</span>
        <span class="token function">before</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_isMounted <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vm<span class="token punctuation">.</span>_isDestroyed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* isRenderWatcher */</span><span class="token punctuation">)</span>		<span class="token comment">//第五个参数标记是渲染函数的watcher</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$vnode <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span>_isMounted <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vm        
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br></div></div><h2 id="beforeupdate"><a href="#beforeupdate" class="header-anchor">#</a> beforeUpdate</h2> <h2 id="updated"><a href="#updated" class="header-anchor">#</a> updated</h2> <h2 id="beforedestory"><a href="#beforedestory" class="header-anchor">#</a> beforeDestory</h2> <h2 id="destory"><a href="#destory" class="header-anchor">#</a> destory</h2> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p><code>beforeCreate</code> ：初始化了部分参数，如果有相同的参数，做了参数合并，执行 <code>beforeCreate</code> ；</p> <p><code>created</code> ：初始化了 <code>Inject</code> 、<code>Provide</code> 、 <code>props</code> 、<code>methods</code> 、<code>data</code> 、<code>computed</code> 和 <code>watch</code>，执行 <code>created</code> ；</p> <p><code>beforeMount</code> ：检查是否存在 <code>el</code> 属性，存在的话进行渲染 <code>dom</code> 操作，执行 <code>beforeMount</code> ；</p> <p><code>mounted</code> ：实例化 <code>Watcher</code> ，渲染 <code>dom</code>，执行 <code>mounted</code> ；</p> <p><code>beforeUpdate</code> ：在渲染 <code>dom</code> 后，执行了 <code>mounted</code> 钩子后，在数据更新的时候，执行 <code>beforeUpdate</code> ；</p> <p><code>updated</code> ：检查当前的 <code>watcher</code> 列表中，是否存在当前要更新数据的 <code>watcher</code> ，如果存在就执行 <code>updated</code> ；</p> <p><code>beforeDestroy</code> ：检查是否已经被卸载，如果已经被卸载，就直接 <code>return</code> 出去，否则执行 <code>beforeDestroy</code> ；</p> <p><code>destroyed</code> ：把所有有关自己痕迹的地方，都给删除掉；</p> <h1 id="虚拟dom"><a href="#虚拟dom" class="header-anchor">#</a> 虚拟DOM</h1> <h2 id="虚拟dom的作用"><a href="#虚拟dom的作用" class="header-anchor">#</a> 虚拟DOM的作用</h2> <p>​		随着Web技术的发展，需要对DOM操作越来越频繁，而频繁操作DOM的耗费的性能代价很大。通过JavaScript中的数据结构抽象模拟DOM节点，找出状态的变化具体影响了哪些节点，并只更新与这个状态相关的DOM节点，可以减少很多性能的消耗。</p> <h2 id="vue的虚拟dom"><a href="#vue的虚拟dom" class="header-anchor">#</a> Vue的虚拟DOM</h2> <p>​		在Vue1.0中，通过更细粒度的状态绑定，可以一定程度上知道具体哪些节点变化，无需比较就可以渲染。但状态追踪的开销很大。Vue2.0通过组件级别的状态绑定，减少了状态追踪的开销。但组件级别的就不能直接去更新真实的DOM，因为会增加很多没必要的回流。因此Vue2.0通过虚拟节点来比较具体哪些节点发生了变化再去渲染。</p> <h2 id="具体过程"><a href="#具体过程" class="header-anchor">#</a> 具体过程</h2> <p>​		<font color="orange">模板组件交过编译转成渲染函数。渲染函数生成最新组件状态的虚拟节点树。新的虚拟节点再和缓存的旧的虚拟节点比较最后更新视图。</font></p> <h2 id="比较算法-patch"><a href="#比较算法-patch" class="header-anchor">#</a> 比较算法 -patch</h2> <p>比较两个虚拟节点的差异只是patch工作的一部分，patch还会修改节点也就是渲染视图。比较的过程为当旧节点不存在直接用新节点渲染视图，当存在旧节点但不是同一个节点，使用新节点替换旧节点渲染视图。当旧节点和新节点存在部分差异时，通过更详细的操作对比进行更新。</p> <h1 id="依赖收集"><a href="#依赖收集" class="header-anchor">#</a> 依赖收集</h1> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//初次渲染</span>
vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在<code>new Watcher</code>时，会自动执行<code>updateComponent</code>进行页面渲染或者更新。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">let</span> <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//new一个watcher实例时会自动执行渲染更新组件函数，如果渲染过程引用了响应式数据，还会将此watcher实例加入到对应的dep列表</span>
    <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h1 id="diff"><a href="#diff" class="header-anchor">#</a> Diff</h1> <p>​		Diff是一种对比算法，通过对比新旧节点判断哪个节点更改了从而只更新对应的真实减少性能损耗。</p> <h2 id="对比原理"><a href="#对比原理" class="header-anchor">#</a> 对比原理</h2> <p>diff算法是深度优先算法，只会进行同层比较，时间复杂度为O(n)</p> <h2 id="对比流程"><a href="#对比流程" class="header-anchor">#</a> 对比流程</h2> <p>当数据更改时，会触发被劫持的setter方法，通过依赖的<code>notify</code>通知所有的<code>watcher</code>，订阅者通过<code>patch</code>方法给真实DOM打补丁更新视图。</p> <ol><li><code>patch</code>先通过sameVnode判断是否是相同类型的标签，不是直接替换新的虚拟节点，是进入下一步</li> <li>是同类型的标签继续patchVnode深层比较</li> <li>patchVnode判断新旧节点是否指向同一个对象、判断是否需要更改文本、是否要新增或删除子节点，如果都有子节点，执行<code>patchVnode</code>比较</li> <li>通过<code>updateChildren</code>比较子节点</li></ol> <p><font color="orange">相同类型的标准：标签名、key值、是否是注释节点、是否有data</font></p> <h2 id="vue2"><a href="#vue2" class="header-anchor">#</a> Vue2</h2> <p>​		vue2虚拟节点采用的是双端比较：旧节点头部和新节点头部比较、旧节点尾部和新节点尾部比较、旧节点头部和新节点尾部比较、旧节点尾巴和新节点头部比较。当找到可复用节点时，头指针后移一位，尾指针前移一位。当新列表或旧列表其中一个遍历完成结束循环。</p> <h3 id="具体流程-双端比较"><a href="#具体流程-双端比较" class="header-anchor">#</a> 具体流程	-双端比较</h3> <ul><li>如果新前和旧前相同，只需要更新视图无需移动节点，否则进入下一步</li> <li>比较旧尾节点和新尾节点，如果相同只需更新视图，否则进入下一步</li> <li>比较旧头节点和新尾节点，如果相同将旧前移动到所有未处理节点的最后面，否则进入下一步</li> <li>比较旧尾节点和新头结点，如果相同将旧尾节点移动到所有未处理节点的最前面，否则在旧节点循环查找</li></ul> <p>以上通过四个变量记录头尾节点，当遍历完新列表或旧列表结束循环。如新节点还有剩下未处理的说明剩下的都是新节点，如果旧节点剩下节点未处理说明是需要删除的节点。</p> <p>需要移动节点都是基于未处理节点是因为比较是基于虚拟节点的，当真实节点头尾已经更新时，会造成乱序</p> <h2 id="vue3"><a href="#vue3" class="header-anchor">#</a> Vue3</h2> <p>vue3重写了vue2的diff算法，主要有如下优化</p> <ul><li><p>事件缓存：当节点上有事件时会先读取缓存，如果缓存没有的话，就把传入的事件存到缓存里，都可以理解为变成静态节点了，优秀吧，而在 Vue2 中就没有缓存，就是动态的</p></li> <li><p>静态标记：vue3在编译时会将静态节点标记为-1，将创建静态节点函数标记为纯函数。</p></li> <li><p>静态提升：Vue3 中会把这个不参与更新的元素保存起来，只创建一次，之后在每次渲染的时候不停地复用</p></li> <li><p>使用最长递增子序列优化对比流程：</p> <ul><li>预处理：先对头部尾部进行比较，发现不同结束循环，取出相同部分</li> <li>保存新节点未比较部分，在建立一个数组存储新节点在旧节点的索引，值为-1说明旧节点不存在的。取出数组的最长递增子序列，根据递增子序列对应节点移动剩下节点。</li></ul></li> <li></li></ul> <h1 id="nexttick"><a href="#nexttick" class="header-anchor">#</a> nextTick</h1> <p>Vue在侦测到数据变化时，不会同步执行DOM更新，而是开启一个队列，缓冲同一事件循环中发生的所有事件变更，在当前栈执行完后，在下一次事件循环才将队列的<code>watcher</code>触发渲染流程清空队列。这样做的目的是为了去除重复数据，避免无必要的计算和DOM操作。Vue通过每个<code>watcher</code>识别是否存在重复watcher。</p> <p><code>vm.$nextTick</code>接收一个<font color="orange">回调函数作为参数,它的作用是将回调延迟到下次DOM更新周期之后执行。</font>它与全局方法 Vue.nextTick 一样，不同的是<font color="orange">回调的<code>this</code>自动绑定到调用它的实例上</font>。<font color="orange">如果没有提供回调且在支持Promise的环境中，则返回一个Promise。</font></p> <h2 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h2> <h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <ul><li>创建一个<code>callback</code>队列存储回调函数；设置一个状态量记录是否已经执行过队列的函数；<code>timerFunc</code>决定在什么时候执行队列中的函数</li></ul> <h3 id="nexttick-2"><a href="#nexttick-2" class="header-anchor">#</a> nextTick</h3> <ul><li><code>nextTick</code>会判断是否传入回调函数，如果有往队列加入一个函数，函数内部通过<code>call</code>绑定上下文执行回调函数；如果状态为false将回调任务通过timerFunc加入任务队列；如果没有传入回调函数且支持promise，则返回一个<code>promise</code></li></ul> <h3 id="timerfunc"><a href="#timerfunc" class="header-anchor">#</a> timerFunc</h3> <p>​		<code>timerFunc</code>通过isNative函数依次判断是否支持Promise.then<code>、</code>MutationObserver<code>和</code>setImmediate，都不支持直接使用<code>setTimeout</code>函数将<code>flushCallbacks</code> 函数放入任务队列，前两个是微任务队列、后两个是加入宏任务队列，不能使用微任务就使用宏任务优雅降级。</p> <h3 id="flushcallbacks"><a href="#flushcallbacks" class="header-anchor">#</a> flushCallbacks</h3> <p>​		依次执行回调队列方法，将pending重置为<code>false</code></p> <h1 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h1> <h2 id="为什么不推荐以index作为key"><a href="#为什么不推荐以index作为key" class="header-anchor">#</a> 为什么不推荐以index作为key</h2> <ul><li>vue的patch在进行新旧节点比较时，如果节点有key属性，会根据key、tag等属性判断新旧节点是否相同，如果直接用index作为key值，当以index作为key时，会动态地改变每次每个结点的key索引，diff以为每个结点的都发生了变化于是重新渲染，最坏情况下会导致整个v-for的结点都重渲染一遍</li></ul> <h2 id="为什么data是一个函数"><a href="#为什么data是一个函数" class="header-anchor">#</a> 为什么data是一个函数</h2> <p>​		Vue的组件是可以共享的，如果同一个组件被多次复用，而其data以对象形式，那么这个组件的data将被共用，各个组件会相互影响，将组件的data写成一个函数，每复用一次组件，就会返回一份新的 data，各个组件实例维护各自的data数据</p> <h2 id="父子组件执行顺序"><a href="#父子组件执行顺序" class="header-anchor">#</a> 父子组件执行顺序</h2> <p><code>父beforeCreate -&gt; 父created -&gt; 父beforeMount -&gt; 子beforeCreated -&gt; 子created -&gt; 子beforeMount -&gt; 子mount -&gt; 父mount</code></p> <h2 id="v-if和v-show"><a href="#v-if和v-show" class="header-anchor">#</a> v-if和v-show</h2> <ul><li><code>v-if</code>会如果为false是直接删除DOM结点，v-if不要和v-for一起使用因为v-for的优先级高，会先渲染所有的结点，再判断是否需要删除，会频繁转成回流。</li> <li><code>v-show</code>是通过修改<code>display</code>状态来决定是否在视图上显示</li></ul> <h1 id="前端路由"><a href="#前端路由" class="header-anchor">#</a> 前端路由</h1> <p>​		Ajax的出现支持在不刷新网页的条件下就能实现异步数据交互。SPA单页面的应用则实现页面交互和页面跳转无刷新。为了实现单页面应用，出现了前端路由。</p> <p>​		前端路由基本思路是匹配不同的url，动态渲染相应的区域html内容。</p> <h2 id="hash模式"><a href="#hash模式" class="header-anchor">#</a> hash模式</h2> <p>​		当一个url的hash发生变化时，浏览器并不会向服务器发送请求。我们可以监听hash的变化，触发不同的页面更新实现前端路由</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>//   http://www.xxx.com/#/login       #后的为hash
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>api<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>a.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
document.querySelectorAll('a').forEach(el =&gt; {
    el.addEventListener('click', function(e) {
        e.preventDefault();					   <span class="token comment">&lt;!--&gt;阻止a标签默认事件&lt;--&gt;</span>
        location.hash = el.textContent;			<span class="token comment">&lt;!--&gt;获取hash值，替换loaction的hash属性&lt;--&gt;</span>
    })
})
let routerView = routeView;
window.addEventListener('hashchange', ()=&gt;{		 <span class="token comment">&lt;!--&gt;监听页面hash，匹配对应视图组件渲染&lt;--&gt;</span>
    let hash = location.hash;
    routerView.innerHTML = hash
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="history模式"><a href="#history模式" class="header-anchor">#</a> history模式</h2> <p>​		<code>html5</code>多出了<code>pushState`` 和</code>replaceState两个<code>api</code>，通过这两个api实现<code>url</code>切换不会出现#号，会更加美观。通过这两个API切换url不会让浏览器去发起新的请求。这两个API都是修改了<code>history</code>对象，push是往对象加了新的URL，replace则是直接替换当前记录，会导致被替换的URL消失。</p> <p><font color="orange">history 提供类似 hashchange 事件的 popstate 事件，但 popstate 事件有些不同：</font></p> <ol><li>通过浏览器前进后退改变 URL 时会触发 <code>popstate</code> 事件</li> <li>通过pushState/replaceState或<code>&lt;a&gt;</code>标签改变 URL 不会触发 popstate 事件。</li> <li>好在我们可以拦截 pushState/replaceState的调用和<code>&lt;a&gt;</code>标签的点击事件来检测 URL 变化</li> <li>通过js 调用history的back，go，forward方法触发该事件</li></ol> <p>通过history模式实现的主要方法是通过<code>popState</code>监听history对象变化渲染对应组件视图。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/home<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>/about<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>about<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>routeView<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> routerView <span class="token operator">=</span> routeView
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> onLoad<span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        routerView<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">function</span> <span class="token function">onLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        routerView<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname
        <span class="token keyword">var</span> linkList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'a[href]'</span><span class="token punctuation">)</span>
        linkList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            routerView<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h1 id="vue-router"><a href="#vue-router" class="header-anchor">#</a> Vue-router</h1> <p><strong>钩子函数</strong></p> <p>1、vue router.beforeEach（全局前置守卫）</p> <blockquote><p>beforeEach的钩子函数，它是一个全局的before 钩子函数， （before each）意思是在 每次每一个路由改变的时候都得执行一遍。</p> <p>它的三个参数：</p> <p>to: (Route路由对象) 即将要进入的目标 路由对象 to对象下面的属性： path params query hash fullPath matched name meta（在matched下，但是本例可以直接用）</p> <p>from: (Route路由对象) 当前导航正要离开的路由</p> <p>next: (Function函数) 一定要调用该方法来 resolve 这个钩子。 调用方法：<strong>next(参数或者空)必须调用</strong></p></blockquote> <p>2、<strong>模块二：路由独享的守卫(路由内钩子)</strong></p> <p>你在路由配置上直接定义 beforeEnter 守卫：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>const router = new VueRouter({
  routes: [
    {
      path: '/foo',
      component: Foo,
      beforeEnter: (to, from, next) =&gt; {
        // ...
      }
    }
  ]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>3、<strong>组件钩子</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">...</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteEnter</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在渲染该组件的对应路由被 confirm 前调用</span>
    <span class="token comment">// 不！能！获取组件实例 `this`</span>
    <span class="token comment">// 因为当守卫执行前，组件实例还没被创建</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteUpdate</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在当前路由改变，但是该组件被复用时调用</span>
    <span class="token comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span>
    <span class="token comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span>
    <span class="token comment">// 可以访问组件实例 `this`</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteLeave</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 导航离开该组件的对应路由时调用</span>
    <span class="token comment">// 可以访问组件实例 `this`</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>4、组件被创建前钩子</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//beforeRouteEnter</span>
<span class="token comment">//守卫不能访问 this，因为守卫在导航确认前被调用,因此即将登场的新组件还没被创建。</span>
可以通过传一个回调给 next来访问组件实例。在导航被确认的时候执行回调，并且把组件实例作为回调方法的参数。
<span class="token function">beforeRouteEnter</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">vm</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 `vm` 访问组件实例</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="template到render的过程"><a href="#template到render的过程" class="header-anchor">#</a> template到render的过程</h1> <p>Vue的编译过程是将模板编译成抽象语法树 - 再将ast编译成<code>render</code>函数</p> <p>vue现在模板编译执行<code>compileToFunction</code>将模板转为渲染函数</p> <h2 id="compiletofunction"><a href="#compiletofunction" class="header-anchor">#</a> compileToFunction</h2> <ol><li><p>调用HTML解析器将模板解析成抽象语法树，HTML解析器本质上是一个函数，第一个参数是模板，第二个参数是选项，在模板解析的过程中触发选项对应的钩子。HTML解析器内部是有一个栈来维护DOM的层级关系，每解析到开始标签就入栈，每当匹配到结束标签就出栈，将构建的结点添加到父节点的下面。对于文本结点而言，分为纯文本和带变量的文本，后者需要二次加工。</p></li> <li><p>将模板解析成抽象语法树后，通过优化器标记静态结点，具体是通过判断结点的type属性（2为带变量、3为纯文本）设置该结点语法树的<code>static</code>属性。每次重新渲染不需要为静态结点创建新结点，在虚拟DOM打补丁时可以跳过。</p></li> <li><p>当优化好AST后，需要递归抽象语法树创建代码字符串。AST结点有元素结点、文本结点、注释结点三种类型。（<code>_c、_v、 _e</code>分别对应三种别名）。字符串会拼接在with中返回给调用者，通过<code>new Function</code>将代码字符串转为函数</p> <ul><li>'with'语句将某个对象添加到作用域链的顶部。</li></ul></li> <li><p>先调用<code>parse</code>将模板转为抽象语法树，用JavaScript数据结构描述模板。
<code>parse</code>是通过正则表达式匹配的内容调用对应的回调来构造语法树。</p></li> <li><p>对AST进行深度遍历，分析标记哪些是静态节点，后续更新时可跳过，减少性能损耗。
节点分为普通元素、表达式、静态节点、纯文本</p></li> <li><p>生成代码，将抽象语法树编译成<code>render</code>字符串，再通过<code>new Function</code>生成渲染函数。</p></li></ol> <h1 id="vue生命周期-2"><a href="#vue生命周期-2" class="header-anchor">#</a> Vue生命周期</h1> <h1 id="watcher实现"><a href="#watcher实现" class="header-anchor">#</a> watcher实现</h1> <p>当new 一个 <code>watcher</code>实例时，其构造函数会在实例上挂载vue实例、挂载回调函数，定义一个<code>getter</code>方法去获取侦测属性，定义一个value值，value会触发类的<code>get</code>方法，get方法内部实际是调用<code>getter</code>方法去获取侦测属性，同时get方法还会将这个watch实例指向一个全局对象，我们想要侦测的对象在watch初始化之前已经转化成响应式数据了，我们在get方法内部获取这个数据时，这个数据的被劫持的get方法会将我们已经指向全局的watch实例加入其dep实例的依赖列表。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
    <span class="token comment">/*
    	第一个参数是vue实例
    	第二个参数是侦测属性
    	第三个参数是回调
    */</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> expOrFn<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm<span class="token punctuation">;</span>	<span class="token comment">//获取vue实例</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>getter <span class="token operator">=</span> <span class="token function">parsePath</span><span class="token punctuation">(</span>expOrFn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
        window<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   	<span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h1 id="watcher和computed"><a href="#watcher和computed" class="header-anchor">#</a> watcher和computed</h1> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//created</span>
<span class="token function">initInjections</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在数据/道具之前解决注入</span>
<span class="token function">initState</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">initProvide</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 解决后提供的数据/道具</span>
<span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> opts <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">;</span>
  <span class="token comment">// vue 的数据来源 属性 方法 数据 计算属性 watch</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initProps</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>methods<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initMethod</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initData</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//数据劫持，同时生成Dep实例存储订阅者watcher</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>computed<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">initComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>opts<span class="token punctuation">.</span>watch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initWatch</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>watch<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/FrancisSaber/image/markdown-Image202203062355704.webp" alt="img"></p> <p>一个Vue实例通常包含3个<code>watcher</code>：分别是初始化数据劫持的data的订阅者，用户创建的watcher、computed（计算属性）的watcher</p> <p>Vue初始化过程中，会执行一个<code>initState</code>方法，initState</p> <h2 id="用户watcher"><a href="#用户watcher" class="header-anchor">#</a> 用户watcher</h2> <p>vue初始化阶段，如果用户定义了<code>watcher</code>，vue会执行<code>initWatch</code>，参数为vue实例和用户定义的<code>watch</code>对象，通过遍历一个<code>watch</code>创建一个<code>watcher</code>实例，<code>createWatcher</code>接收四个参数，分别是vue实例、<code>watcher</code>的属性名、回调函数，以及<code>options</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initWatch</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> watch</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> watch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> handler <span class="token operator">=</span> watch<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>		<span class="token comment">//获取回调</span>
		<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
		options<span class="token punctuation">.</span>deep <span class="token operator">=</span> watch<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>deep<span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">//是否深度监听</span>
		options<span class="token punctuation">.</span>immediate <span class="token operator">=</span> watch<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>immediate<span class="token punctuation">]</span><span class="token punctuation">;</span>	<span class="token comment">//是否立即执行</span>
		<span class="token function">createWatcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span>key<span class="token punctuation">,</span>handler<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//创建实例</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">createWatcher</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span>key<span class="token punctuation">,</span>handler<span class="token punctuation">,</span>options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    options<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>		<span class="token comment">//标记为用户watcher</span>
    <span class="token keyword">return</span> vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span>key<span class="token punctuation">,</span>handler<span class="token punctuation">,</span>options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h2> <ol><li>调用的时候才会执行（通过数据劫持得知依赖是否调用）</li> <li>有缓存</li> <li>依赖改变时会重新计算</li></ol> <p>Vue.js支持对象和函数类型的计算属性，如果是函数将函数视为getter函数，如果是对象将对象的set视为setter方法，get视为getter方法。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>2.5.2computed原理
使用计算属性的模板会使用`watcher`读取计算属性，计算属性会订阅它所用到的数据，当数据发生变化时，计算属性的`watcher`会收到通知，将自身的`dirty`置为true，模板组件也会收到通知需要重新读取计算属性，发现计算属性`dirty`为true，需要重新计算。

当一个模板使用了计算属性，触发的是计算属性的`getter`方法（不同于获取一个响应式数据触发其`get`内部方法）。`getter`方法会观察计算属性所引用者的变化，同时将dirty置为false声名值已经缓存，当计算属性再次被访问时，如果`dirty`为`false`，无需重新计算。

如果是在模板使用了计算属性，模板的watcher会观察计算属性所用到的所有数据，在数据变化时模板组件和计算属性的watcher都会收到通知；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>Watcher</code>类内部定义了<code>evaluate</code>方法用于重新计算属性值和将dirty置为<code>false</code>声名值已经缓存；</p> <p><font color="orange">计算属性的依赖数组会保存它所用到的响应式数据的<code>dep</code>实例，当模板使用了计算属性时，模板自身的订阅者会被指向一个全局属性，depend方法会将组件的watcher加到每个用到状态的dep实例，让组件能在数据变化时得到通知。</font></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> exportFn<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	
        <span class="token keyword">this</span><span class="token punctuation">.</span>deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">fn</span> <span class="token operator">=&gt;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong><font color="orange">最新版的计算属性实现</font></strong></p> <p>先前的版本会导致如果计算属性依赖的某个状态改变了，模板收到通知进行重渲染，但是计算属性重新计算后结果是不变的，组件仍会重新渲染，只不过diff算法没有发现变化，UI也不会变化。<font color="orange">这个因为计算属性只是观察其用到的数据是否改变，不会校验最终的值是否改变</font></p> <p><font color="orange">于是现在组件的模板的<code>watcher</code>只是观察计算属性的<code>watcher</code>（就是观察计算属性的返回值），不会观察计算属性所用到全部数据，因此数据变化了只有计算属性的watcher收到通知，计算属性要重新计算校验再判断是否通知模板的watcher。</font></p> <p>新版计算属性的<code>watcher</code>通过内部的depend方法将使用计算属性的<code>watcher</code>加入到计算属性的依赖列表内。</p> <p>当计算属性收到数据变化通知时，通过<code>update</code>方法判断自身是否是一个计算属性的watcher，是的话将dirty置为<code>true</code>，是否执行响应回调要判断值是否改变再触发。</p> <h3 id="计算属性初始化"><a href="#计算属性初始化" class="header-anchor">#</a> 计算属性初始化</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">//如果定义了计算属性对其初始化</span>
        <span class="token function">inintComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>computed<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">initComputed</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> computed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> watchers <span class="token operator">=</span> vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// 创建一个纯净对象</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//遍历用户定义的每个计算数学，</span>
    <span class="token keyword">const</span> getter <span class="token operator">=</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span>  <span class="token comment">// computed每项对应的回调函数</span>
    <span class="token comment">// 实例化computed-watcher</span>
    watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> getter<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">lazy</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="计算属性初始化-2"><a href="#计算属性初始化-2" class="header-anchor">#</a> 计算属性初始化</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">;</span>
        <span class="token keyword">const</span> watcher <span class="token operator">=</span> temp <span class="token operator">&amp;&amp;</span> temp<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h2> <p>​		当模板中的某个值需要通过一个或多个数据计算得到时，就可以使用计算属性，还有计算属性的函数不接受参数；监听属性主要是监听某个值发生变化后，对新值去进行逻辑处理。</p> <h1 id="render-watcher"><a href="#render-watcher" class="header-anchor">#</a> render-watcher</h1> <p>​		对于状态的更新，每个组件都会执行<code>$mount</code>方法，<code>render</code>方法会创建一个唯一的<code>render watcher</code>，在<code>watcher</code>执行render回调生成虚拟节点的过程中，会访问视图用到的<code>data</code>数据和计算属性，因为数据已经被处理成响应式，因此此<code>render-watcher</code>会被加入到这些响应式属性的<code>dep</code>内，当状态改变时，<code>render-watcher</code>会被通知重新渲染视图。（视图的渲染是通过<code>nextTick</code>实现的，是为避免每个数据都通知一遍<code>render-watcer</code>回调，造成没必要的性能损耗）。</p> <p>​		另外<code>$mount</code>选择的挂载点只是个占位符，挂载是占位节点会被替换，因此不能挂载在body或html标签上，否则不符合标准文档。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//Vue执行$mount方法内部会执行mountComponent函数</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$mount</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token operator">?</span><span class="token operator">:</span> any<span class="token punctuation">,</span> hydrating</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> el <span class="token operator">&amp;&amp;</span> <span class="token function">query</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$document<span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/*
	在init内进行选项合并和一系列初始化后(同时会暴露钩子函数)，判断是否存在挂载节点，如果存在执行$mount
*/</span>
<span class="token function">initLifecycle</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
<span class="token function">initEvents</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
<span class="token function">initRender</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
<span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeCreate'</span><span class="token punctuation">)</span>
<span class="token function">initInjections</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> <span class="token comment">// resolve injections before data/props</span>
<span class="token function">initState</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span>
<span class="token function">initProvide</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span> <span class="token comment">// resolve provide after data/props</span>
<span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'created'</span><span class="token punctuation">)</span>
<span class="token comment">/*
	vue在init执行过程会判断是否传入了el，是自动挂载，返回vue实例，
	如果没有传执行会报错
*/</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
    mountComponent定义在lifecycle.js内
    1.先将vm上挂载传入的el（el可以是字符串或DOM元素，如果是字符串通过query获取对应的DOM）
    2.如果options没有提供render函数
        2.1判断是否
    3.在mountComponent定义updateComponent方法
    	3.1updateComponent内部是通过_render方法生成虚拟节点
    	3.2之后通过_update更新对虚拟节点进行patch比较
    4.在初始化好updateComponent方法后，实例化一个renderWatcher去执行updateCompoent方法同时进行依赖收集
	5.最后将vm._isMount标志属性置为true，表示示例是否已经挂载，通知执行mount钩子函数
*/</span>

<span class="token comment">//不完全代码</span>
<span class="token function">mountCompomet</span><span class="token punctuation">(</span><span class="token parameter">vm <span class="token punctuation">,</span>el<span class="token punctuation">,</span> hydrating</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> el<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">//如果没有提供render函数</span>
		vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render <span class="token operator">=</span> createEmptyVNode<span class="token punctuation">;</span>	<span class="token comment">//创建一个空节点</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token function-variable function">updateComponet</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> vnode <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//会将虚拟节点挂载到vue实例上，同时patch比较</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//组件已挂载且未被销毁</span>
            <span class="token function">callback</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/FrancisSaber/image/markdown-Image202203311111216.jpeg" alt="在这里插入图片描述"></p> <h1 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h1> <p>Vuex的注入代码比较简单，调用了一下<code>applyMixin</code>方法，现在的版本其实就是调用了<code>Vue.mixin</code>，在所有组件的 <strong>beforeCreate</strong>生命周期注入了设置 <strong>this.$store</strong>这样一个对象。</p> <h2 id="实现-2"><a href="#实现-2" class="header-anchor">#</a> 实现</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//Vuex.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Store</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">state</span><span class="token operator">:</span> options<span class="token punctuation">.</span>state <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> getters <span class="token operator">=</span> options<span class="token punctuation">.</span>getter <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token comment">//实现getters</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>getters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        Objects<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>getters<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">getterName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>getters<span class="token punctuation">,</span> getterName<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>getters<span class="token punctuation">[</span>getterName<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">//mutation同理</span>
        <span class="token keyword">let</span> mutation <span class="token operator">=</span> options<span class="token punctuation">.</span>mutation <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mutation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>mutation<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">mutationName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mutation<span class="token punctuation">[</span>mutationName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                mutation<span class="token punctuation">[</span>mutationName<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> actions <span class="token operator">=</span> options<span class="token punctuation">.</span>actions <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>actions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>actions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">actionName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">[</span>actionName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                actions<span class="token punctuation">[</span>actionName<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">get</span> <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   	<span class="token function-variable function">commit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>mutation<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token parameter">method<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>actions<span class="token punctuation">[</span>method<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">//插件被安装时，会使用Vue.mixin在</span>
    vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>store<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>$store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span>store<span class="token punctuation">;</span>		<span class="token comment">//在vue组件上添加$store属性</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>$store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parents <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$parents<span class="token punctuation">.</span>store<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> Vuex <span class="token operator">=</span> <span class="token punctuation">{</span>
    install<span class="token punctuation">,</span>
    Store
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// store.js</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'Vuex'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
    <span class="token literal-property property">getter</span><span class="token operator">:</span><span class="token punctuation">{</span>
    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//具体使用时，会先创建store实例，执行Vue.use再将实例挂载到每个组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//mian.js</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'store'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//执行Vue.use 会将Vue实例作为参数的install的参数传入，</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h1 id="vue-use"><a href="#vue-use" class="header-anchor">#</a> Vue.use</h1> <p><code>Vue.use</code>是用来安装插件的。</p> <p><strong>用法</strong>：</p> <p>Vue.use(plugin)</p> <ul><li><strong>如果插件是一个对象</strong>，必须提供 <code>install</code> 方法。</li> <li><strong>如果插件是一个函数，它会被作为 install 方法</strong>。install 方法调用时，<code>会将 Vue 作为参数传入</code>。</li> <li>Vue.use(plugin)调用之后，插件的install方法就会默认接受到一个参数，这个参数就是Vue（原理部分会将）</li></ul> <h1 id="spa"><a href="#spa" class="header-anchor">#</a> SPA</h1> <p>​		Vue是单页面应用，就是客户端渲染。浏览器所需要的html、css、js等资源在一次<code>url</code>请求就可以全部加载完毕，无需动态刷新请求；客户端渲染就是页面渲染、逻辑处理、路由切换全都是在浏览器进行的。</p> <p>​		单页面应用的好处在于视图切换更快，无需等待服务器响应特别是在网络条件差的情况下；SPA的缺点是不利于SEO。</p> <h1 id="组件通信方式"><a href="#组件通信方式" class="header-anchor">#</a> 组件通信方式</h1> <h2 id="props、emit-最常用的父子通讯方式"><a href="#props、emit-最常用的父子通讯方式" class="header-anchor">#</a> props、emit(最常用的父子通讯方式)</h2> <h2 id="vuex-2"><a href="#vuex-2" class="header-anchor">#</a> Vuex</h2> <h2 id="refs"><a href="#refs" class="header-anchor">#</a> $refs</h2> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 在template中
// ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hello<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hello-world</span><span class="token punctuation">&gt;</span></span>
// ...
export default {
  mounted(){
    // 调用引用的子组件的方法
    this.$refs.hello.handleRef()
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="provide-inject-祖先及其后代传值"><a href="#provide-inject-祖先及其后代传值" class="header-anchor">#</a> provide / inject （祖先及其后代传值）</h2> <p><strong>常用一些多个组件嵌套封装，一个顶层组件内部的后代组件需要用到顶层组件的数据就使用这种方式</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//  顶层组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">provide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'hello world!'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//  后代组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">inject</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="事件总线"><a href="#事件总线" class="header-anchor">#</a> 事件总线</h2> <h2 id="attrs-和-listeners"><a href="#attrs-和-listeners" class="header-anchor">#</a> $attrs 和 listeners</h2> <p><strong>$attrs 可以获取父组件传进来但没有通过props接收的属性</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 父组件</span>
<span class="token operator">&lt;</span>Child <span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">&quot;title&quot;</span> <span class="token operator">:</span>desc<span class="token operator">=</span><span class="token string">&quot;desc&quot;</span> <span class="token operator">&gt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">//  子组件内</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>$attrs<span class="token punctuation">.</span>desc<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>	
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>

复制代码
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><hr> <p><strong>$listeners 会展开父组件的所有监听的事件（click事件等）常用于更高层级的封装</strong> <strong>举个例子（需求）：一个页面中有两个组件的点击事件触发方法是一样的&quot;</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//  父组件</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>child<span class="token operator">-</span>first @click<span class="token operator">=</span><span class="token string">&quot;handleClick&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>child<span class="token operator">-</span>first<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>child<span class="token operator">-</span>second @click<span class="token operator">=</span><span class="token string">&quot;handleClick&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>child<span class="token operator">-</span>second<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">handleClick</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// child-first</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span>on<span class="token operator">=</span><span class="token string">&quot;$listeners&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">// child-second</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span>on<span class="token operator">=</span><span class="token string">&quot;$listeners&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h1 id="vue-directive"><a href="#vue-directive" class="header-anchor">#</a> Vue.directive</h1> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>options <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span>options<span class="token punctuation">[</span><span class="token string">'directivs'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function-variable function">directive</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> definition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>definition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">[</span><span class="token string">'directives'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> definition <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            definition  <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">bind</span><span class="token operator">:</span> definition<span class="token punctuation">,</span> <span class="token literal-property property">update</span><span class="token operator">:</span> definition<span class="token punctuation">}</span>
       <span class="token punctuation">}</span> 
       <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">[</span>directives<span class="token punctuation">]</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> definition<span class="token punctuation">;</span>
        <span class="token keyword">return</span> definition<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>实现</strong></p> <ol><li>先在Vue构造函数上创建<code>options</code>属性来存放选项，在选项增加了<code>directives</code>方法存放指令</li> <li>当使用了<code>directive</code>方法时，如果没有传第二个参数，说明是获取自定义指令，通过id在options的<code>directives</code>取得响应指令；如果传来第二个参数，说明是注册事件，对于函数默认监听bind和update事件，</li></ol> <h1 id="vue-mixin"><a href="#vue-mixin" class="header-anchor">#</a> Vue.mixin</h1> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>mergeOptions<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../util.index'</span><span class="token punctuation">;</span>
<span class="token comment">//调用mergeOptions将用户传入的对象将Vue自身选项属性进行合并</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initMixin</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> mixin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h1 id="v-model"><a href="#v-model" class="header-anchor">#</a> v-model</h1> <p><code>v-model</code>是<code>:value=&quot;msg&quot;、&quot;[@input]=&quot;msg=$event.target.value</code>的语法糖
其中<code>:value=&quot;msg&quot;</code>是绑定了数据，value就是input输入框里的值；<code>[@input]=&quot;msg=$event.target.value&quot;</code>
就是监听<code>input</code>输入框里值的变化，然后改变值。
一句话概括就是，绑定数据并且监听数据改变</p> <p><font color="orange">v-model本质上是一个语法糖，会忽略表单元素<code>value</code>、<code>checked</code>、<code>selected</code> <strong>等属性（<code>attribute</code>）的初始值</strong>，而是会将Vue实例的数据作为数据来源，通常是定义在<code>data</code>函数内的数据，v-model会监听用户输入事件以更新数据，</font></p> <p><code>v-model</code>内部为不同的输入元素使用不同属性并抛出不同事件</p> <ul><li><code>text</code>和<code>texterea</code>使用<code>value</code>属性和<code>input</code>事件同步更新数据</li> <li><code>checkbox</code>和<code>radio</code>使用checked属性和change事件（即更新checked属性对应在<code>data</code>的值）</li> <li><code>select</code>字段将<code>value</code>作为<code>prop</code>和<code>change</code>事件</li></ul> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text || textera<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox || radio<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--&gt;对于select标签，当select标签的value值与选择的option的value值相同&lt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>120px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>25px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>dog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>cat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

document.getElementById(&quot;select&quot;).onchange = function(e) {
	value = e.target.value;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/FrancisSaber/image/markdown-Image202203310117989.png" alt="image-20220331011704860"></p> <p>实现双向绑定的原理</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'test'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面的效果相当于</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!--&gt;原生&lt;--&gt;</span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--&gt;Vue用法&lt;--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>e =&gt; msg = e.target.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>e =&gt; msg = e.target.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>texterea</span> <span class="token attr-name">:vlaue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>e =&gt; msg = e.target.value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--&gt;
	当触发输入框的input事件，将输出框的value值赋给绑定的value对象
&lt;--&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-vue line-numbers-mode"><pre class="language-vue"><code>// 父组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>父组件的值{{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child</span><span class="token punctuation">&gt;</span></span> 
       <span class="token comment">&lt;!-- v-model等价于以下写法 --&gt;</span>
       <span class="token comment">&lt;!-- &lt;Child :value=&quot;num&quot; @input='val=&gt;num=val'&gt;&lt;/Child&gt; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> Child <span class="token keyword">from</span> <span class="token string">&quot;./components/Child.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">num</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    Child<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

//子组件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>子组件接收的值{{value}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>change<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>点击修改<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
     <span class="token literal-property property">props</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token comment">// 这里的值的名字一定要叫value 因为v-modle双向绑定的就是value属性</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span>Number<span class="token punctuation">,</span>
                <span class="token literal-property property">required</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">// $emit触发父组件的输入框的input事件修改接收的值 父组件中跟着变化 （v-model）</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="sync"><a href="#sync" class="header-anchor">#</a> .sync</h2> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Child</span> <span class="token attr-name">:a.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num<span class="token punctuation">&quot;</span></span> <span class="token attr-name">.b.sync</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>num2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Child</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--&gt;
	效果如下，自动绑定了update方法
    &lt;Child 
      :a=&quot;num&quot; @update:a=&quot;val=&gt;num=val&quot;
      :b=&quot;num2&quot; @update:b=&quot;val=&gt;num2=val&quot;&gt;
    &lt;/Child&gt;
&lt;--&gt;</span>
<span class="token comment">&lt;!--&gt;
    父子组件中使用.sync通信 ,子组件用props接收传递的值(绑定的属性名自己决定) 在子组件中通过$emit方法触发'update:属性名'事件 实现父组件子组件值同时变化
&lt;--&gt;</span>
<span class="token comment">&lt;!--&gt;子组件&lt;--&gt;</span>
$emit('update:属性名',要修改的值)
$emit('update: a', this)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h1 id="vue设计模式"><a href="#vue设计模式" class="header-anchor">#</a> Vue设计模式</h1> <ol><li>单例模式：</li> <li>工厂模式：虚拟节点的创建</li> <li>观察者模式：<code>dep</code>和<code>watcher</code></li> <li>代理模式：_data属性、<code>proxy</code></li> <li>中介者模型：Vuex</li></ol> <h1 id="为什么不能异步执行mutation"><a href="#为什么不能异步执行mutation" class="header-anchor">#</a> 为什么不能异步执行mutation</h1> <p>Vuex中所有的状态更新呢都是mutation，Vuex通过actions派发异步操作来提交<code>mutation</code>从而实现状态追踪，如果直接通过<code>mutation</code>进行异步操作，就无法明确地知道状态是什么时候更新的。因此Vuex通过actions派发异步操作，actions内部也是在异步操作完成时通过<code>mutation</code>提交的。</p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/ccyblog/blogs/mian-shi/vuexiang-ying-shi.html" class="prev">
            过程
          </a></span> <span class="next"><a href="/ccyblog/blogs/mian-shi/wbepackliu-cheng.html">
            Webpack
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#mvc" class="sidebar-link reco-side-mvc" data-v-70334359>MVC</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#mvvm" class="sidebar-link reco-side-mvvm" data-v-70334359>MVVM</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#区别" class="sidebar-link reco-side-区别" data-v-70334359>区别</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#vue模型" class="sidebar-link reco-side-vue模型" data-v-70334359>Vue模型</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#beforecreate" class="sidebar-link reco-side-beforecreate" data-v-70334359>beforeCreate</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#created" class="sidebar-link reco-side-created" data-v-70334359>created</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#beforemount" class="sidebar-link reco-side-beforemount" data-v-70334359>beforeMount</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#mount" class="sidebar-link reco-side-mount" data-v-70334359>mount</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#beforeupdate" class="sidebar-link reco-side-beforeupdate" data-v-70334359>beforeUpdate</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#updated" class="sidebar-link reco-side-updated" data-v-70334359>updated</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#beforedestory" class="sidebar-link reco-side-beforedestory" data-v-70334359>beforeDestory</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#destory" class="sidebar-link reco-side-destory" data-v-70334359>destory</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#总结" class="sidebar-link reco-side-总结" data-v-70334359>总结</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#虚拟dom的作用" class="sidebar-link reco-side-虚拟dom的作用" data-v-70334359>虚拟DOM的作用</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#vue的虚拟dom" class="sidebar-link reco-side-vue的虚拟dom" data-v-70334359>Vue的虚拟DOM</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#具体过程" class="sidebar-link reco-side-具体过程" data-v-70334359>具体过程</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#比较算法-patch" class="sidebar-link reco-side-比较算法-patch" data-v-70334359>比较算法 -patch</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#对比原理" class="sidebar-link reco-side-对比原理" data-v-70334359>对比原理</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#对比流程" class="sidebar-link reco-side-对比流程" data-v-70334359>对比流程</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#vue2" class="sidebar-link reco-side-vue2" data-v-70334359>Vue2</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#具体流程-双端比较" class="sidebar-link reco-side-具体流程-双端比较" data-v-70334359>具体流程	-双端比较</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#vue3" class="sidebar-link reco-side-vue3" data-v-70334359>Vue3</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#实现" class="sidebar-link reco-side-实现" data-v-70334359>实现</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#初始化" class="sidebar-link reco-side-初始化" data-v-70334359>初始化</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#nexttick-2" class="sidebar-link reco-side-nexttick-2" data-v-70334359>nextTick</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#timerfunc" class="sidebar-link reco-side-timerfunc" data-v-70334359>timerFunc</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#flushcallbacks" class="sidebar-link reco-side-flushcallbacks" data-v-70334359>flushCallbacks</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#为什么不推荐以index作为key" class="sidebar-link reco-side-为什么不推荐以index作为key" data-v-70334359>为什么不推荐以index作为key</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#为什么data是一个函数" class="sidebar-link reco-side-为什么data是一个函数" data-v-70334359>为什么data是一个函数</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#父子组件执行顺序" class="sidebar-link reco-side-父子组件执行顺序" data-v-70334359>父子组件执行顺序</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#v-if和v-show" class="sidebar-link reco-side-v-if和v-show" data-v-70334359>v-if和v-show</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#hash模式" class="sidebar-link reco-side-hash模式" data-v-70334359>hash模式</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#history模式" class="sidebar-link reco-side-history模式" data-v-70334359>history模式</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#compiletofunction" class="sidebar-link reco-side-compiletofunction" data-v-70334359>compileToFunction</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#用户watcher" class="sidebar-link reco-side-用户watcher" data-v-70334359>用户watcher</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#computed" class="sidebar-link reco-side-computed" data-v-70334359>computed</a></li><li class="level-3" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#计算属性初始化" class="sidebar-link reco-side-计算属性初始化" data-v-70334359>计算属性初始化</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#计算属性初始化-2" class="sidebar-link reco-side-计算属性初始化-2" data-v-70334359>计算属性初始化</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#使用场景" class="sidebar-link reco-side-使用场景" data-v-70334359>使用场景</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#实现-2" class="sidebar-link reco-side-实现-2" data-v-70334359>实现</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#props、emit-最常用的父子通讯方式" class="sidebar-link reco-side-props、emit-最常用的父子通讯方式" data-v-70334359>props、emit(最常用的父子通讯方式)</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#vuex-2" class="sidebar-link reco-side-vuex-2" data-v-70334359>Vuex</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#refs" class="sidebar-link reco-side-refs" data-v-70334359>$refs</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#provide-inject-祖先及其后代传值" class="sidebar-link reco-side-provide-inject-祖先及其后代传值" data-v-70334359>provide / inject （祖先及其后代传值）</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#事件总线" class="sidebar-link reco-side-事件总线" data-v-70334359>事件总线</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#attrs-和-listeners" class="sidebar-link reco-side-attrs-和-listeners" data-v-70334359>$attrs 和 listeners</a></li><li class="level-2" data-v-70334359><a href="/ccyblog/blogs/mian-shi/vuezheng-li.html#sync" class="sidebar-link reco-side-sync" data-v-70334359>.sync</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-6e863240><div class="banniang-container" style="display:;" data-v-6e863240><div class="messageBox" style="right:88px;bottom:270px;display:none;" data-v-6e863240></div> <div class="operation" style="right:15px;bottom:100px;" data-v-6e863240><i class="kbnfont kbn-ban-home ban-home" data-v-6e863240></i> <i class="kbnfont kbn-ban-message message" data-v-6e863240></i> <i class="kbnfont kbn-ban-info info" data-v-6e863240></i> <i class="kbnfont kbn-ban-close close" data-v-6e863240></i></div> <div id="L2dCanvas" class="Canvas" style="position: absolute; bottom: -50px;z-index:100000" data-v-6e863240></div></div> <div class="showBanNiang" style="display:none;" data-v-6e863240>看板娘</div></div><!----></div></div>
    <script src="/ccyblog/assets/js/app.61cc9ff9.js" defer></script><script src="/ccyblog/assets/js/3.897744a6.js" defer></script><script src="/ccyblog/assets/js/1.371d3697.js" defer></script><script src="/ccyblog/assets/js/74.d901de2d.js" defer></script><script src="/ccyblog/assets/js/8.b19724a0.js" defer></script>
  </body>
</html>
